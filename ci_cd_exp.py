import os

import tensorflow as tf
cwd = os.path.abspath(os.path.dirname(__file__))

# Define the possible classes (numbers 0 to 9)
number_class = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9']

def get_num_class(probability_result):
    """Returns the class with the highest probability."""
    # Use argmax to find the index of the maximum probability
    return number_class[tf.argmax(probability_result[0])]
def resizing_img(img):
    """Preprocesses and resizes the input image for model prediction."""
    img = tf.image.decode_jpeg(img)
    img = tf.image.resize(img, [28, 28])
    img = tf.squeeze(img, axis=-1)
    img = img / 255.0
    img = tf.expand_dims(img, axis=0)
    return img

def get_transformed_ip_data_for_model(IMG_FILE):

    img_path = os.path.join(cwd, "test_images", IMG_FILE)
    img = tf.io.read_file(img_path)

    # Preprocess and resize the image
    img = resizing_img(img)

    # Convert to list for Vertex AI endpoint prediction
    return img.numpy().tolist()

# load model from file
new_model = tf.keras.models.load_model('/Users/shlok/Documents/Tech/codebase/python-playground/MNIST_model')
# Show the model architecture
# new_model.summary()

ip_data = get_transformed_ip_data_for_model("img_7.jpg")          # img_7.jpg ==     [[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0117647061124444, 0.0, 0.0, 0.027450980618596077, 0.019607843831181526, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0117647061124444, 0.03529411926865578, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.027450980618596077, 0.0, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.027450980618596077, 0.0117647061124444, 0.003921568859368563, 0.007843137718737125, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0235294122248888, 0.0235294122248888, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0, 0.0, 0.03921568766236305, 0.054901961237192154, 0.0117647061124444, 0.0, 0.007843137718737125, 0.007843137718737125, 0.007843137718737125, 0.003921568859368563, 0.003921568859368563, 0.007843137718737125, 0.0117647061124444, 0.003921568859368563, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0117647061124444, 0.0, 0.0, 0.01568627543747425, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0117647061124444, 0.0313725508749485, 0.04313725605607033, 0.0235294122248888, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.0313725508749485, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3137255012989044, 0.7921568751335144, 0.7411764860153198, 0.21176470816135406, 0.0, 0.01568627543747425, 0.019607843831181526, 0.0, 0.0, 0.04313725605607033, 0.15294118225574493, 0.1921568661928177, 0.0941176488995552, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.027450980618596077, 0.0117647061124444, 0.0, 0.1411764770746231, 0.9490196108818054, 0.9686274528503418, 0.9921568632125854, 0.47058823704719543, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.5098039507865906, 1.0, 0.8313725590705872, 0.11764705926179886, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0313725508749485, 0.0, 0.0, 0.0235294122248888, 0.027450980618596077, 0.0, 0.0, 0.0, 0.0117647061124444, 0.7137255072593689, 1.0, 0.95686274766922, 1.0, 0.9098039269447327, 0.3176470696926117, 0.0, 0.07450980693101883, 0.4274509847164154, 0.8901960849761963, 0.9490196108818054, 0.9921568632125854, 0.9529411792755127, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.019607843831181526, 0.0, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.01568627543747425, 0.29411765933036804, 0.95686274766922, 0.9686274528503418, 0.6352941393852234, 0.5098039507865906, 0.9058823585510254, 1.0, 0.95686274766922, 0.9490196108818054, 0.9882352948188782, 0.9882352948188782, 1.0, 1.0, 0.4274509847164154, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0117647061124444, 0.027450980618596077, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.5960784554481506, 1.0, 0.95686274766922, 0.16078431904315948, 0.03529411926865578, 0.6392157077789307, 1.0, 0.9411764740943909, 0.7686274647712708, 0.9411764740943909, 1.0, 0.9058823585510254, 0.6392157077789307, 0.07058823853731155, 0.0, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0], [0.003921568859368563, 0.0, 0.0, 0.0, 0.027450980618596077, 0.027450980618596077, 0.0, 0.062745101749897, 0.8470588326454163, 0.929411768913269, 0.6274510025978088, 0.0235294122248888, 0.03529411926865578, 0.01568627543747425, 0.0313725508749485, 0.1568627506494522, 0.12941177189350128, 0.8235294222831726, 1.0, 0.9372549057006836, 0.18039216101169586, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0313725508749485, 0.0, 0.0, 0.007843137718737125, 0.007843137718737125, 0.0, 0.03921568766236305, 0.40784314274787903, 1.0, 0.9921568632125854, 0.3843137323856354, 0.007843137718737125, 0.0, 0.0, 0.01568627543747425, 0.0, 0.5254902243614197, 0.9882352948188782, 0.9019607901573181, 0.6666666865348816, 0.0235294122248888, 0.0, 0.03921568766236305, 0.0, 0.0, 0.0, 0.0, 0.0], [0.019607843831181526, 0.0, 0.0313725508749485, 0.0, 0.0, 0.0, 0.04313725605607033, 0.4470588266849518, 0.772549033164978, 0.4117647111415863, 0.0, 0.027450980618596077, 0.0, 0.0, 0.07058823853731155, 0.2549019753932953, 0.9176470637321472, 1.0, 0.8470588326454163, 0.16078431904315948, 0.0, 0.062745101749897, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0235294122248888, 0.0, 0.03921568766236305, 0.06666667014360428, 0.0, 0.03921568766236305, 0.01568627543747425, 0.0, 0.0, 0.03529411926865578, 0.01568627543747425, 0.0, 0.007843137718737125, 0.7176470756530762, 0.95686274766922, 1.0, 0.29019609093666077, 0.0, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0313725508749485, 0.0, 0.01568627543747425, 0.0, 0.03921568766236305, 0.3529411852359772, 0.9411764740943909, 0.9843137264251709, 0.6784313917160034, 0.04313725605607033, 0.0, 0.05098039284348488, 0.0, 0.054901961237192154, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0313725508749485, 0.01568627543747425, 0.03529411926865578, 0.007843137718737125, 0.0, 0.21960784494876862, 1.0, 1.0, 0.7568627595901489, 0.07450980693101883, 0.0, 0.0313725508749485, 0.0, 0.0, 0.0, 0.03529411926865578, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.09019608050584793, 0.6705882549285889, 0.9529411792755127, 0.8901960849761963, 0.4117647111415863, 0.0, 0.003921568859368563, 0.0784313753247261, 0.0, 0.03921568766236305, 0.003921568859368563, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235294122248888, 0.0, 0.08627451211214066, 0.04313725605607033, 0.40784314274787903, 1.0, 0.9254902005195618, 0.22745098173618317, 0.03529411926865578, 0.04313725605607033, 0.0, 0.0, 0.0, 0.007843137718737125, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.019607843831181526, 0.0, 0.33725491166114807, 0.9098039269447327, 0.9843137264251709, 0.6039215922355652, 0.0, 0.0, 0.08627451211214066, 0.0, 0.0, 0.062745101749897, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235294122248888, 0.07450980693101883, 0.7333333492279053, 1.0, 0.6705882549285889, 0.0, 0.09019608050584793, 0.0, 0.01568627543747425, 0.019607843831181526, 0.019607843831181526, 0.01568627543747425, 0.0, 0.01568627543747425, 0.0470588244497776, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007843137718737125, 0.0941176488995552, 0.7960784435272217, 0.9254902005195618, 0.7686274647712708, 0.3176470696926117, 0.0, 0.0, 0.003921568859368563, 0.0, 0.04313725605607033, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5098039507865906, 1.0, 1.0, 0.4117647111415863, 0.03921568766236305, 0.0, 0.019607843831181526, 0.007843137718737125, 0.0, 0.0, 0.007843137718737125, 0.0470588244497776, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3294117748737335, 1.0, 0.9411764740943909, 0.7254902124404907, 0.14509804546833038, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6705882549285889, 1.0, 1.0, 0.32549020648002625, 0.0, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8784313797950745, 0.9372549057006836, 0.9686274528503418, 0.21176470816135406, 0.05098039284348488, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06666667014360428, 0.04313725605607033, 0.0, 0.0, 0.0, 0.007843137718737125, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]]
print("ASHOK 1 instances ==> ", type(ip_data))
prediction_result = new_model.predict(ip_data)
print(prediction_result)


# Print the predicted class
print("This number is: ", get_num_class(prediction_result))

print("ASHOK 2 instances ==> ", type([[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0117647061124444, 0.0, 0.0, 0.027450980618596077, 0.019607843831181526, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0117647061124444, 0.03529411926865578, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.027450980618596077, 0.0, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.027450980618596077, 0.0117647061124444, 0.003921568859368563, 0.007843137718737125, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0235294122248888, 0.0235294122248888, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0, 0.0, 0.03921568766236305, 0.054901961237192154, 0.0117647061124444, 0.0, 0.007843137718737125, 0.007843137718737125, 0.007843137718737125, 0.003921568859368563, 0.003921568859368563, 0.007843137718737125, 0.0117647061124444, 0.003921568859368563, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0117647061124444, 0.0, 0.0, 0.01568627543747425, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0117647061124444, 0.0313725508749485, 0.04313725605607033, 0.0235294122248888, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.0313725508749485, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3137255012989044, 0.7921568751335144, 0.7411764860153198, 0.21176470816135406, 0.0, 0.01568627543747425, 0.019607843831181526, 0.0, 0.0, 0.04313725605607033, 0.15294118225574493, 0.1921568661928177, 0.0941176488995552, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.027450980618596077, 0.0117647061124444, 0.0, 0.1411764770746231, 0.9490196108818054, 0.9686274528503418, 0.9921568632125854, 0.47058823704719543, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.5098039507865906, 1.0, 0.8313725590705872, 0.11764705926179886, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0313725508749485, 0.0, 0.0, 0.0235294122248888, 0.027450980618596077, 0.0, 0.0, 0.0, 0.0117647061124444, 0.7137255072593689, 1.0, 0.95686274766922, 1.0, 0.9098039269447327, 0.3176470696926117, 0.0, 0.07450980693101883, 0.4274509847164154, 0.8901960849761963, 0.9490196108818054, 0.9921568632125854, 0.9529411792755127, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.019607843831181526, 0.0, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.01568627543747425, 0.29411765933036804, 0.95686274766922, 0.9686274528503418, 0.6352941393852234, 0.5098039507865906, 0.9058823585510254, 1.0, 0.95686274766922, 0.9490196108818054, 0.9882352948188782, 0.9882352948188782, 1.0, 1.0, 0.4274509847164154, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0117647061124444, 0.027450980618596077, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.5960784554481506, 1.0, 0.95686274766922, 0.16078431904315948, 0.03529411926865578, 0.6392157077789307, 1.0, 0.9411764740943909, 0.7686274647712708, 0.9411764740943909, 1.0, 0.9058823585510254, 0.6392157077789307, 0.07058823853731155, 0.0, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0], [0.003921568859368563, 0.0, 0.0, 0.0, 0.027450980618596077, 0.027450980618596077, 0.0, 0.062745101749897, 0.8470588326454163, 0.929411768913269, 0.6274510025978088, 0.0235294122248888, 0.03529411926865578, 0.01568627543747425, 0.0313725508749485, 0.1568627506494522, 0.12941177189350128, 0.8235294222831726, 1.0, 0.9372549057006836, 0.18039216101169586, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0313725508749485, 0.0, 0.0, 0.007843137718737125, 0.007843137718737125, 0.0, 0.03921568766236305, 0.40784314274787903, 1.0, 0.9921568632125854, 0.3843137323856354, 0.007843137718737125, 0.0, 0.0, 0.01568627543747425, 0.0, 0.5254902243614197, 0.9882352948188782, 0.9019607901573181, 0.6666666865348816, 0.0235294122248888, 0.0, 0.03921568766236305, 0.0, 0.0, 0.0, 0.0, 0.0], [0.019607843831181526, 0.0, 0.0313725508749485, 0.0, 0.0, 0.0, 0.04313725605607033, 0.4470588266849518, 0.772549033164978, 0.4117647111415863, 0.0, 0.027450980618596077, 0.0, 0.0, 0.07058823853731155, 0.2549019753932953, 0.9176470637321472, 1.0, 0.8470588326454163, 0.16078431904315948, 0.0, 0.062745101749897, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0235294122248888, 0.0, 0.03921568766236305, 0.06666667014360428, 0.0, 0.03921568766236305, 0.01568627543747425, 0.0, 0.0, 0.03529411926865578, 0.01568627543747425, 0.0, 0.007843137718737125, 0.7176470756530762, 0.95686274766922, 1.0, 0.29019609093666077, 0.0, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0313725508749485, 0.0, 0.01568627543747425, 0.0, 0.03921568766236305, 0.3529411852359772, 0.9411764740943909, 0.9843137264251709, 0.6784313917160034, 0.04313725605607033, 0.0, 0.05098039284348488, 0.0, 0.054901961237192154, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0313725508749485, 0.01568627543747425, 0.03529411926865578, 0.007843137718737125, 0.0, 0.21960784494876862, 1.0, 1.0, 0.7568627595901489, 0.07450980693101883, 0.0, 0.0313725508749485, 0.0, 0.0, 0.0, 0.03529411926865578, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.09019608050584793, 0.6705882549285889, 0.9529411792755127, 0.8901960849761963, 0.4117647111415863, 0.0, 0.003921568859368563, 0.0784313753247261, 0.0, 0.03921568766236305, 0.003921568859368563, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235294122248888, 0.0, 0.08627451211214066, 0.04313725605607033, 0.40784314274787903, 1.0, 0.9254902005195618, 0.22745098173618317, 0.03529411926865578, 0.04313725605607033, 0.0, 0.0, 0.0, 0.007843137718737125, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.019607843831181526, 0.0, 0.33725491166114807, 0.9098039269447327, 0.9843137264251709, 0.6039215922355652, 0.0, 0.0, 0.08627451211214066, 0.0, 0.0, 0.062745101749897, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235294122248888, 0.07450980693101883, 0.7333333492279053, 1.0, 0.6705882549285889, 0.0, 0.09019608050584793, 0.0, 0.01568627543747425, 0.019607843831181526, 0.019607843831181526, 0.01568627543747425, 0.0, 0.01568627543747425, 0.0470588244497776, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007843137718737125, 0.0941176488995552, 0.7960784435272217, 0.9254902005195618, 0.7686274647712708, 0.3176470696926117, 0.0, 0.0, 0.003921568859368563, 0.0, 0.04313725605607033, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5098039507865906, 1.0, 1.0, 0.4117647111415863, 0.03921568766236305, 0.0, 0.019607843831181526, 0.007843137718737125, 0.0, 0.0, 0.007843137718737125, 0.0470588244497776, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3294117748737335, 1.0, 0.9411764740943909, 0.7254902124404907, 0.14509804546833038, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6705882549285889, 1.0, 1.0, 0.32549020648002625, 0.0, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8784313797950745, 0.9372549057006836, 0.9686274528503418, 0.21176470816135406, 0.05098039284348488, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06666667014360428, 0.04313725605607033, 0.0, 0.0, 0.0, 0.007843137718737125, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]]))
prediction_result = new_model.predict([[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0117647061124444, 0.0, 0.0, 0.027450980618596077, 0.019607843831181526, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0117647061124444, 0.03529411926865578, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.027450980618596077, 0.0, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.027450980618596077, 0.0117647061124444, 0.003921568859368563, 0.007843137718737125, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0235294122248888, 0.0235294122248888, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.0, 0.0, 0.03921568766236305, 0.054901961237192154, 0.0117647061124444, 0.0, 0.007843137718737125, 0.007843137718737125, 0.007843137718737125, 0.003921568859368563, 0.003921568859368563, 0.007843137718737125, 0.0117647061124444, 0.003921568859368563, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0117647061124444, 0.0, 0.0, 0.01568627543747425, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.0117647061124444, 0.0313725508749485, 0.04313725605607033, 0.0235294122248888, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.0313725508749485, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3137255012989044, 0.7921568751335144, 0.7411764860153198, 0.21176470816135406, 0.0, 0.01568627543747425, 0.019607843831181526, 0.0, 0.0, 0.04313725605607033, 0.15294118225574493, 0.1921568661928177, 0.0941176488995552, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.027450980618596077, 0.0117647061124444, 0.0, 0.1411764770746231, 0.9490196108818054, 0.9686274528503418, 0.9921568632125854, 0.47058823704719543, 0.0, 0.0, 0.0, 0.0, 0.01568627543747425, 0.5098039507865906, 1.0, 0.8313725590705872, 0.11764705926179886, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0313725508749485, 0.0, 0.0, 0.0235294122248888, 0.027450980618596077, 0.0, 0.0, 0.0, 0.0117647061124444, 0.7137255072593689, 1.0, 0.95686274766922, 1.0, 0.9098039269447327, 0.3176470696926117, 0.0, 0.07450980693101883, 0.4274509847164154, 0.8901960849761963, 0.9490196108818054, 0.9921568632125854, 0.9529411792755127, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.019607843831181526, 0.0, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.01568627543747425, 0.29411765933036804, 0.95686274766922, 0.9686274528503418, 0.6352941393852234, 0.5098039507865906, 0.9058823585510254, 1.0, 0.95686274766922, 0.9490196108818054, 0.9882352948188782, 0.9882352948188782, 1.0, 1.0, 0.4274509847164154, 0.0, 0.003921568859368563, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0117647061124444, 0.027450980618596077, 0.0, 0.0, 0.0117647061124444, 0.0, 0.0, 0.5960784554481506, 1.0, 0.95686274766922, 0.16078431904315948, 0.03529411926865578, 0.6392157077789307, 1.0, 0.9411764740943909, 0.7686274647712708, 0.9411764740943909, 1.0, 0.9058823585510254, 0.6392157077789307, 0.07058823853731155, 0.0, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0], [0.003921568859368563, 0.0, 0.0, 0.0, 0.027450980618596077, 0.027450980618596077, 0.0, 0.062745101749897, 0.8470588326454163, 0.929411768913269, 0.6274510025978088, 0.0235294122248888, 0.03529411926865578, 0.01568627543747425, 0.0313725508749485, 0.1568627506494522, 0.12941177189350128, 0.8235294222831726, 1.0, 0.9372549057006836, 0.18039216101169586, 0.0, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0313725508749485, 0.0, 0.0, 0.007843137718737125, 0.007843137718737125, 0.0, 0.03921568766236305, 0.40784314274787903, 1.0, 0.9921568632125854, 0.3843137323856354, 0.007843137718737125, 0.0, 0.0, 0.01568627543747425, 0.0, 0.5254902243614197, 0.9882352948188782, 0.9019607901573181, 0.6666666865348816, 0.0235294122248888, 0.0, 0.03921568766236305, 0.0, 0.0, 0.0, 0.0, 0.0], [0.019607843831181526, 0.0, 0.0313725508749485, 0.0, 0.0, 0.0, 0.04313725605607033, 0.4470588266849518, 0.772549033164978, 0.4117647111415863, 0.0, 0.027450980618596077, 0.0, 0.0, 0.07058823853731155, 0.2549019753932953, 0.9176470637321472, 1.0, 0.8470588326454163, 0.16078431904315948, 0.0, 0.062745101749897, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0235294122248888, 0.0, 0.03921568766236305, 0.06666667014360428, 0.0, 0.03921568766236305, 0.01568627543747425, 0.0, 0.0, 0.03529411926865578, 0.01568627543747425, 0.0, 0.007843137718737125, 0.7176470756530762, 0.95686274766922, 1.0, 0.29019609093666077, 0.0, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0313725508749485, 0.0, 0.01568627543747425, 0.0, 0.03921568766236305, 0.3529411852359772, 0.9411764740943909, 0.9843137264251709, 0.6784313917160034, 0.04313725605607033, 0.0, 0.05098039284348488, 0.0, 0.054901961237192154, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0313725508749485, 0.01568627543747425, 0.03529411926865578, 0.007843137718737125, 0.0, 0.21960784494876862, 1.0, 1.0, 0.7568627595901489, 0.07450980693101883, 0.0, 0.0313725508749485, 0.0, 0.0, 0.0, 0.03529411926865578, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003921568859368563, 0.09019608050584793, 0.6705882549285889, 0.9529411792755127, 0.8901960849761963, 0.4117647111415863, 0.0, 0.003921568859368563, 0.0784313753247261, 0.0, 0.03921568766236305, 0.003921568859368563, 0.01568627543747425, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235294122248888, 0.0, 0.08627451211214066, 0.04313725605607033, 0.40784314274787903, 1.0, 0.9254902005195618, 0.22745098173618317, 0.03529411926865578, 0.04313725605607033, 0.0, 0.0, 0.0, 0.007843137718737125, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0117647061124444, 0.019607843831181526, 0.0, 0.33725491166114807, 0.9098039269447327, 0.9843137264251709, 0.6039215922355652, 0.0, 0.0, 0.08627451211214066, 0.0, 0.0, 0.062745101749897, 0.0, 0.0, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235294122248888, 0.07450980693101883, 0.7333333492279053, 1.0, 0.6705882549285889, 0.0, 0.09019608050584793, 0.0, 0.01568627543747425, 0.019607843831181526, 0.019607843831181526, 0.01568627543747425, 0.0, 0.01568627543747425, 0.0470588244497776, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007843137718737125, 0.0941176488995552, 0.7960784435272217, 0.9254902005195618, 0.7686274647712708, 0.3176470696926117, 0.0, 0.0, 0.003921568859368563, 0.0, 0.04313725605607033, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5098039507865906, 1.0, 1.0, 0.4117647111415863, 0.03921568766236305, 0.0, 0.019607843831181526, 0.007843137718737125, 0.0, 0.0, 0.007843137718737125, 0.0470588244497776, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3294117748737335, 1.0, 0.9411764740943909, 0.7254902124404907, 0.14509804546833038, 0.0117647061124444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6705882549285889, 1.0, 1.0, 0.32549020648002625, 0.0, 0.0, 0.0, 0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8784313797950745, 0.9372549057006836, 0.9686274528503418, 0.21176470816135406, 0.05098039284348488, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06666667014360428, 0.04313725605607033, 0.0, 0.0, 0.0, 0.007843137718737125, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]])
print(prediction_result)
# <class 'list'>

# Print the predicted class
print("This number is: ", get_num_class(prediction_result))

